<script>
  AFRAME.registerComponent('registerevents', {
      init: function () 
      {
          let marker = this.el;
          let follower = document.querySelector("#follower");
          let followerPlane = document.querySelector("#followerPlane");
          
          marker.addEventListener('markerFound', function() {
              // check if marker is found for the first time;
              //  if so, make object visible and align position/rotation.
              if ( follower.getAttribute("active") == "0" )
              {
                  follower.setAttribute("active", "1");
                  followerPlane.setAttribute("material", "visible", "true");   
              }
              markerVisible = true;
          });
  
          marker.addEventListener('markerLost', function() {
              markerVisible = false;
          });
          
          this.p = new THREE.Vector3();
          this.q = new THREE.Quaternion();
          this.s = new THREE.Vector3();   
      },
      
      tick: function (time, deltaTime) 
      {
          // if marker is visible, align the entity to the marker
          if (markerVisible)
          {
              let marker = this.el;
              let follower = document.querySelector("#follower");
              let followerPlane = document.querySelector("#followerPlane");
  
              let lerpAmount = 0.5;
  
              marker.object3D.getWorldPosition(this.p);
              marker.object3D.getWorldQuaternion(this.q);
              marker.object3D.getWorldScale(this.s);
  
              follower.object3D.position.lerp(this.p, lerpAmount);
              follower.object3D.quaternion.slerp(this.q, lerpAmount);
              follower.object3D.scale.lerp(this.s, lerpAmount);
              
              followerPlane.setAttribute("color", "green");
          } 
          else
          {
              followerPlane.setAttribute("color", "red");            
          }
      }
  });
      AFRAME.registerComponent('updater', {
      
          init: function()
          {
              // declare variable for later access
              this.num = 0;
              // you can also access the underlying 3D object of a scene object,
              //   for example:
              // let target = document.querySelector('#earth').object3D;
              // target.scale.set( 0.75, 0.75, 0.75 );
          },
          
          // time      = total time since init (milliseconds)
          // timeDelta = time since last tick
          tick: function (time, timeDelta) 
          {
              this.num += 1;
              // console.log( this.num );
          }
          
      });
      
      // access underlying 3D object this component is attached to
      AFRAME.registerComponent('spinner', {
      
          init: function()
          {
              this.el.object3D.scale.set(0.75, 0.75, 0.75);
          },
          
          tick: function (time, timeDelta) 
          {
              this.el.object3D.rotation.y += 0.01
          }
          
      });
      
      
      </script>
<a-scene embedded arjs>
  
      <a-assets>
      <img id="earth-sphere" src="../../../assets/images/earth-sphere.jpeg" />
          <a-asset-item id="back" src="../../../assets/models/hoverboard.glb"></a-asset-item>
    </a-assets>
      <a-marker type="hiro">
          <a-plane id="followerPlane"
          position="0 0 0"
          rotation="-90 0 0"
          color = "green"
          material="src:#earth-sphere;">
   </a-plane>
  
      </a-marker>
      <a-marker type="pattern" url="../../../assets/presets/letterB.patt" >
          <a-sphere position="0 0.5 0" 
          material="src: #earth-sphere; transparent: true; opacity: 0.95;"
          animation__rotate = "property: rotation; dur: 8000; easing: linear; dir: normal; from:0 0 0; to: 0 360 0; loop: true;">
          </a-sphere>
      </a-marker> 
        <a-marker type="pattern" url="../../../assets/presets/letterA.patt" >
          <a-sphere 
          id="earth"
          position="0 0.5 0" 
          material="src: #earth-sphere; transparent: true; opacity: 0.95;"
          spinner >
          
   </a-sphere>
      <!--a-marker type="pattern" url="../../../assets/presets/letterA.patt" >
          <a-entity   position="0 0 0" 
          rotation="0 0 0"
          scale="0.50 0.50 0.50"
          gltf-model="#back" >
  </a-entity-->
  </a-marker>
          <a-entity camera></a-entity>
  
      <!-- empty entity, running previously declared script -->
      <a-entity updater></a-entity>
      </a-scene>

  